/Users/esamsoe/miniforge3/envs/mpg-horses/lib/python3.13/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/Users/esamsoe/miniforge3/envs/mpg-horses/lib/python3.13/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet18_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet18_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
Random seed set to 42
Using device: mps
Loading dataset from mpg-ranch/horse-detection
Using authentication for Hugging Face
Loading dataset from cache: data/cached_datasets/mpg-ranch_horse-detection.parquet
Loaded cached dataset with 12780 samples
Creating data loaders
Dataset type: <class 'pandas.core.frame.DataFrame'>
Dataset columns: ['idx', 'Presence', 'Zone', 'Period', 'Recency', 'datetime_groundtruth', 'datetime_aerialsurvey', 'Latitude', 'Longitude', 'Easting', 'Northing', 'Ellipsoidal_height', 'orthomosaic', 'tile_path', 'observation_offset', 'encoded_tile', '__index_level_0__', 'image_base64']
Dataset size: 12780
Label distribution: Presence
1    7100
0    5680
Name: count, dtype: int64
Training set size: 10224
Testing set size: 2556
Creating cnn model
Using device: mps
Epoch 1/30 [Train]:   0%|          | 0/639 [00:00<?, ?it/s]Traceback (most recent call last):
  File "<string>", line 1, in <module>
    from multiprocessing.spawn import spawn_main; spawn_main(tracker_fd=7, pipe_handle=24)
                                                  ~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/esamsoe/miniforge3/envs/mpg-horses/lib/python3.13/multiprocessing/spawn.py", line 122, in spawn_main
    exitcode = _main(fd, parent_sentinel)
  File "/Users/esamsoe/miniforge3/envs/mpg-horses/lib/python3.13/multiprocessing/spawn.py", line 132, in _main
    self = reduction.pickle.load(from_parent)
_pickle.UnpicklingError: pickle data was truncated
/Users/esamsoe/miniforge3/envs/mpg-horses/lib/python3.13/multiprocessing/resource_tracker.py:276: UserWarning: resource_tracker: There appear to be 12 leaked semaphore objects to clean up at shutdown: {'/loky-17665-whabjd1z', '/loky-17665-byv1q7r7', '/loky-17665-1pmoye1q', '/loky-17665-37omq8fn', '/loky-17665-869gleg1', '/loky-17665-zqf62f93', '/loky-17665-cuciy85c', '/loky-17665-ycg54gub', '/loky-17665-8q4g4_nc', '/loky-17665-1cl2x35n', '/loky-17665-h75avovh', '/loky-17665-47wo89ze'}
  warnings.warn(
